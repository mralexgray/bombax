<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Bombaxtic Framework: BxFile Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.2 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>BxFile Class Reference</h1><!-- doxytag: class="BxFile" -->
<p>Contains information about uploaded POST files.  
<a href="#_details">More...</a></p>

<p><a href="class_bx_file-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Properties</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">NSUInteger&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_bx_file.html#a9b926742992d6cede6f509aad1e04ca4">length</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">NSFileHandle *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_bx_file.html#a8185467a87eb8c9a0ac5e68174efd88d">handle</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">NSString *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_bx_file.html#af0642f8ca68292a73bb78acebadfc186">fileName</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">NSString *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_bx_file.html#a481de1116148f0dd4e30e82942f929a6">formName</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">NSString *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_bx_file.html#ae150f5ef82bd93b00c4769d87b132319">mimeType</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">NSString *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_bx_file.html#a9333bda4309d810f37853afc51b5129b">tempFilePath</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Contains information about uploaded POST files. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Bombaxtic LLC - <a href="http://www.bombaxtic.com">http://www.bombaxtic.com</a> </dd></dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.0</dd></dl>
<p>When a file is uploaded via an HTML form, it is included as a special kind of POST variable. <a class="el" href="interface_bx_transport.html" title="Handles communication with HTTP client.">BxTransport</a> handles the upload of these files and makes them available as an array of <a class="el" href="interface_bx_file.html" title="Contains information about uploaded POST files.">BxFile</a> instances through BxTransport's <a class="el" href="interface_bx_transport.html#uploadedFiles">uploadedFiles</a> property.</p>
<p><a class="el" href="interface_bx_file.html" title="Contains information about uploaded POST files.">BxFile</a> instances contain a variety of information about the POST file uploaded including the MIME type, form variable name, and file name. In addition to this information, the <a class="el" href="interface_bx_file.html" title="Contains information about uploaded POST files.">BxFile</a> provides direct access to the actual file itself.</p>
<dl class="warning"><dt><b>Warning:</b></dt><dd>The uploaded file is stored in a temporary directory and may not be retained between server restarts or even different client connections. For this reason, it is highly recommended that if you to persist the file, you move it to a more permanent location.</dd></dl>
<p>Example of persisting a BxFile's contents: </p>
<div class="fragment"><pre class="fragment"> - (id)renderWithTransport:(<a class="code" href="interface_bx_transport.html" title="Handles communication with HTTP client.">BxTransport</a> *)transport {
     <a class="code" href="interface_bx_file.html" title="Contains information about uploaded POST files.">BxFile</a> *file = [transport.uploadedFiles objectAtIndex:0];
     <span class="keywordflow">if</span> (file != nil) {
         [file.handle closeFile];
         NSError *error;
         [[NSFileManager defaultManager] moveItemAtPath:file.tempFilePath
                                                 toPath:@&quot;/path/to/uploads&quot;
                                                  error:&amp;error];
         <span class="keywordflow">if</span> (error == nil) {
             [transport <a class="code" href="interface_bx_transport.html#ad37d502b2dc0f1e4c5ed3c001c10d263" title="Writes the given NSString to the response stream.">write</a>:@&quot;Successfully uploaded.&quot;];
         }
     }
     <span class="keywordflow">return</span> <span class="keyword">self</span>;
 }
</pre></div><dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="interface_bx_transport.html" title="Handles communication with HTTP client.">BxTransport</a>, especially <a class="el" href="interface_bx_transport.html#uploadedFiles">uploadedFiles</a> </dd></dl>
<hr/><h2>Property Documentation</h2>
<a class="anchor" id="af0642f8ca68292a73bb78acebadfc186"></a><!-- doxytag: member="BxFile::fileName" ref="af0642f8ca68292a73bb78acebadfc186" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (NSString*) fileName<code> [read, assign]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="anchor" id="fileName"></a> This is the name of the file uploaded, as it existed on the client.</p>
<p>Example of ensuring an uploaded PNG file has the .png extension: </p>
<div class="fragment"><pre class="fragment"> - (id)renderWithTransport:(<a class="code" href="interface_bx_transport.html" title="Handles communication with HTTP client.">BxTransport</a> *)transport {
     NSFile *file = [transport.uploadedFiles objectAtIndex:0];
     <span class="keywordflow">if</span> (file != nil &amp;&amp;
      [file.mimeType isEqualToString:<span class="stringliteral">@&quot;image/png&quot;</span>] &amp;&amp;
      [[file.fileName pathExtension] caseInsensitiveCompare:<span class="stringliteral">@&quot;png&quot;</span>] == NSOrderedSame) {
         <span class="comment">// ... handle upload</span>
     }
     <span class="keywordflow">return</span> <span class="keyword">self</span>;
 }
</pre></div> <dl class="since"><dt><b>Since:</b></dt><dd>1.0 </dd></dl>

</div>
</div>
<a class="anchor" id="a481de1116148f0dd4e30e82942f929a6"></a><!-- doxytag: member="BxFile::formName" ref="a481de1116148f0dd4e30e82942f929a6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (NSString*) formName<code> [read, assign]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="anchor" id="formName"></a> The variable name used for the file in the uploading form.</p>
<p>Example of distinguishing between two files using formName in BXML: </p>
<div class="fragment"><pre class="fragment"> &lt;html&gt;
  &lt;body&gt;
   &lt;? 
    <span class="keywordflow">if</span> ([_.uploadedFiles count] == 0) {
        <span class="keywordflow">for</span> (<a class="code" href="interface_bx_file.html" title="Contains information about uploaded POST files.">BxFile</a> *file in _.uploadedFiles) {
            <span class="keywordflow">if</span> ([file.formName isEqualToString:<span class="stringliteral">@&quot;file1&quot;</span>]) {
                [_ writeFormat:@&quot;File 1 has %d bytes.&quot;, file.length];
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ([file.formName isEqualToString:<span class="stringliteral">@&quot;file2&quot;</span>]) {
                [_ writeFormat:@&quot;File 2 has %d bytes.&quot;, file.length];
            }
        }
    } <span class="keywordflow">else</span> { ?&gt;
   &lt;form method=<span class="stringliteral">&quot;POST&quot;</span>&gt;
    &lt;input type=<span class="stringliteral">&quot;file&quot;</span> name=<span class="stringliteral">&quot;file1&quot;</span> /&gt;
    &lt;input type=<span class="stringliteral">&quot;file&quot;</span> name=<span class="stringliteral">&quot;file2&quot;</span> /&gt;
    &lt;input type=<span class="stringliteral">&quot;submit&quot;</span> /&gt;
   &lt;/form&gt;
   &lt;? } ?&gt;
  &lt;/body&gt;
 &lt;/html&gt;
</pre></div> <dl class="since"><dt><b>Since:</b></dt><dd>1.0 </dd></dl>

</div>
</div>
<a class="anchor" id="a8185467a87eb8c9a0ac5e68174efd88d"></a><!-- doxytag: member="BxFile::handle" ref="a8185467a87eb8c9a0ac5e68174efd88d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (NSFileHandle*) handle<code> [read, assign]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="anchor" id="handle"></a> This is the file handle already opened for reading.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>The handle is open for read only. To write to the file, close the handle and open a new writeable NSFileHandle using tempFilePath.</dd></dl>
<p>Example writing the file's data out to the client: </p>
<div class="fragment"><pre class="fragment"> - (id)renderWithTransport:(<a class="code" href="interface_bx_transport.html" title="Handles communication with HTTP client.">BxTransport</a> *)transport {
     NSFile *file = [transport.uploadedFiles objectAtIndex:0];
     <span class="keywordflow">if</span> (file != nil) {
         [transport <a class="code" href="interface_bx_transport.html#ac3652708542b77e69fb8c5062301ccdc" title="Sets an HTTP header to be sent back to the client.">setHeader</a>:@&quot;Content-Type&quot; <a class="code" href="interface_bx_transport.html#ac3652708542b77e69fb8c5062301ccdc" title="Sets an HTTP header to be sent back to the client.">value</a>:file.mimeType];
         [transport <a class="code" href="interface_bx_transport.html#a4601e2e0c992c3f27be65b74b9160e3c" title="Writes the given NSData to the response stream.">writeData</a>:[file.handle readDataToEndOfFile]];
     }
     <span class="keywordflow">return</span> <span class="keyword">self</span>;
 }
</pre></div> <dl class="since"><dt><b>Since:</b></dt><dd>1.0 </dd></dl>

</div>
</div>
<a class="anchor" id="a9b926742992d6cede6f509aad1e04ca4"></a><!-- doxytag: member="BxFile::length" ref="a9b926742992d6cede6f509aad1e04ca4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (NSUInteger) length<code> [read, assign]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="anchor" id="length"></a> The file length of the uploaded file in bytes</p>
<p>Example of testing length of file: </p>
<div class="fragment"><pre class="fragment"> - (id)renderWithTransport:(<a class="code" href="interface_bx_transport.html" title="Handles communication with HTTP client.">BxTransport</a> *)transport {
     NSFile *file = [transport.uploadedFiles objectAtIndex:0];
     <span class="keywordflow">if</span> (file == nil || file.length == 0) {
         [transport <a class="code" href="interface_bx_transport.html#ad37d502b2dc0f1e4c5ed3c001c10d263" title="Writes the given NSString to the response stream.">write</a>:@&quot;Empty file&quot;];
     }
     <span class="keywordflow">return</span> <span class="keyword">self</span>;
 }
</pre></div> <dl class="since"><dt><b>Since:</b></dt><dd>1.0 </dd></dl>

</div>
</div>
<a class="anchor" id="ae150f5ef82bd93b00c4769d87b132319"></a><!-- doxytag: member="BxFile::mimeType" ref="ae150f5ef82bd93b00c4769d87b132319" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (NSString*) mimeType<code> [read, assign]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="anchor" id="mimeType"></a> This is the MIME type as passed according to the client.</p>
<dl class="warning"><dt><b>Warning:</b></dt><dd>Although the MIME type is normally determined automatically by the client's browser and file system, it can be faked and should not be considered a definite description of the file's contents.</dd></dl>
<p>Example determining how to handle a file based on its MIME type: </p>
<div class="fragment"><pre class="fragment"> - (id)renderWithTransport:(<a class="code" href="interface_bx_transport.html" title="Handles communication with HTTP client.">BxTransport</a> *)transport {
     NSFile *file = [transport.uploadedFiles objectAtIndex:0];
     <span class="keywordflow">if</span> (file != nil) {
         <span class="keywordflow">if</span> ([file.mimeType hasPrefix:<span class="stringliteral">@&quot;image&quot;</span>]) {
             <span class="comment">// ... handle as image file</span>
         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ([file.mimeType hasPrefix:<span class="stringliteral">@&quot;video&quot;</span>]) {
             <span class="comment">// ... handle as video file</span>
         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ([file.mimeType hasPrefix:<span class="stringliteral">@&quot;audio&quot;</span>]) {
             <span class="comment">// ... handle as audio file</span>
         }
     }
     <span class="keywordflow">return</span> <span class="keyword">self</span>;
 }
</pre></div> <dl class="see"><dt><b>See also:</b></dt><dd>For a list of registered MIME types, see <a href="http://www.iana.org/assignments/media-types/">http://www.iana.org/assignments/media-types/</a> </dd></dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.0 </dd></dl>

</div>
</div>
<a class="anchor" id="a9333bda4309d810f37853afc51b5129b"></a><!-- doxytag: member="BxFile::tempFilePath" ref="a9333bda4309d810f37853afc51b5129b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (NSString*) tempFilePath<code> [read, assign]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="anchor" id="tempFilePath"></a> This is absolute path to the file itself.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>When the <a class="el" href="interface_bx_file.html" title="Contains information about uploaded POST files.">BxFile</a> is created, the file is open via the handle and this should be closed prior to deleting or moving the file.</dd></dl>
<p>Example of deleting the file: </p>
<div class="fragment"><pre class="fragment"> - (id)renderWithTransport:(<a class="code" href="interface_bx_transport.html" title="Handles communication with HTTP client.">BxTransport</a> *)transport {
     NSFile *file = [transport.uploadedFiles objectAtIndex:0];
     <span class="keywordflow">if</span> (file != nil) {
         <span class="comment">// ... process file</span>
         [file.handle closeFile];
         NSError *error;
         [[NSFileManager defaultManager] removeItemAtPath:file.tempFilePath error:&amp;error];
         <span class="keywordflow">if</span> (error == nil) {
             [transport <a class="code" href="interface_bx_transport.html#ad37d502b2dc0f1e4c5ed3c001c10d263" title="Writes the given NSString to the response stream.">write</a>:@&quot;File processed and removed.&quot;];
         }
     }
     <span class="keywordflow">return</span> <span class="keyword">self</span>;
 }
</pre></div> <dl class="since"><dt><b>Since:</b></dt><dd>1.0 </dd></dl>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Properties</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</body>
</html>
